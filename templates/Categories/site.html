{% extends 'base.html' %}
{% load static %}
{% block title %}Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© - Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/site.css' %}">
{% endblock %}

{% block content %}
<div class="site-container">
  {% if messages %}
    <div class="messages">
      {% for message in messages %}
        <div class="alert {{ message.tags }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}

  <div class="site-table-container">
    <table class="site-table">
      <thead>
        <tr>
          <th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
          <th>ÙØ§Ø±Ù‚ Ø§Ù„Ø£ÙŠØ§Ù…</th>
          <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡</th>
          <th>Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
          <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
        </tr>
      </thead>
      <tbody>
        {% for Site in categories %}
        <tr>
          <td>{{ Site.name }}</td>
          <td>{{ Site.number_of_days }}</td>
          <td>{{ Site.start_date }}</td>
          <td>
            {% if Site.site_link %}
              <a href="{{ Site.site_link }}" target="_blank">Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹</a>
            {% else %}
              <span style="color: #6c757d;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø§Ø¨Ø·</span>
            {% endif %}
          </td>
          <td>
            <div class="action-buttons">
              {% if request.user.role == "manager" %}
                <a href="{% url 'edit_site' Site.id %}" class="edit-btn">âœï¸ ØªØ¹Ø¯ÙŠÙ„</a>
                <a href="{% url 'delete_site' Site.id %}" class="delete-btn" onclick="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŸ');">ğŸ—‘ï¸ Ø­Ø°Ù</a>
              {% else %}
                <span class="no-permission">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙ„Ø§Ø­ÙŠØ©</span>
              {% endif %}
            </div>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" style="text-align: center; padding: 30px; color: #6c757d;">
            Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹ Ù…Ø¶Ø§ÙØ© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  {% if request.user.role == "manager" %}
  <div class="add-site-form">
    <h2>â• Ø¥Ø¶Ø§ÙØ© Ù…ÙˆÙ‚Ø¹ Ø¬Ø¯ÙŠØ¯</h2>
    <form method="post">
      {% csrf_token %}
      <div class="form-fields">
        {% for field in form %}
        <div class="form-group">
          <label for="{{ field.id_for_label }}">{{ field.label }}</label>
          {{ field }}
          {% if field.help_text %}
            <small style="color: #6c757d; margin-top: 5px;">{{ field.help_text }}</small>
          {% endif %}
          {% for error in field.errors %}
            <div style="color: #e74a3b; margin-top: 5px;">{{ error }}</div>
          {% endfor %}
        </div>
        {% endfor %}
      </div>
      <button type="submit" class="submit-btn">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
    </form>
  </div>
  {% endif %}
</div>
{% endblock %}